<html>
	<head>
        <title>Scan QR Codes</title>
    	<script type="text/javascript" src = "https://cdnjs.cloudflare.com/ajax/libs/webrtc-adapter/3.3.3/adapter.min.js"></script>
    	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.10/vue.min.js"></script>
    	<script type="text/javascript" src = "https://rawgit.com/schmich/instascan-builds/master/instascan.min.js"></script>
		<link  rel="stylesheet" href="https://myskypower.net/components/modal/modal.css">
        <script src="https://myskypower.net/components/modal/modal.js" defer></script>
    	<link id ="pageStyle" href="style.css" rel="stylesheet">
	</head>
	<body>
        <div id="main">
            <a class="openbtn" id="opener" role="button">&#9776;</a>
            <span id="Heading">Scan QR Codes</span><br>
            <div id="chooseType">
                <a id= "scanner" class= "main_button" onclick="setNewButton()">Qr Code Scanner</a>
                <a id= "sheetsEmbed" class= "main_button" onclick="setExisting()">Spreadsheet View</a>
                <span class="vl"></span>
                <select name="selectSheet" id="selectSheet" onchange="setSheet()">
                    <option value="none" selected disabled hidden>Select Spreadsheet</option>
                    <option value="1mWEevuxx14kUZDClKsAREUGJvUWeXwoPDNK12aJPijY">Instruments</option>
                    <option value="1FFqn2Oh-zi8j8foW5iq8qd_-m-hLk8LVrAXJpPa3Lo0">Books</option>
                </select>
                <button class="main_button">Open in Google Sheets
                    <!--<span class="tabicon">
                        <span class="open_tab_span"><img class="open_tab_icon" width="20px" height="20px"src="https://static.thenounproject.com/png/3629744-200.png"></span>    Open in Google Sheets
                    </span>-->
                </button>
                <span class="vl"></span>
                <button class="main_button" id="steinify">Steinify!</button>
            </div> 

        </div>
        <div id="mySidebar" class="sidebar">
            <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
            <a href="#">Scan</a>
            <a href="edit.html">Sheets</a>
            <a href="#account">Account</a>
            <a href="#home">About</a>
        </div>

        <div class="split left" id="leftSplit">
            <iframe id="frame" width="650" height ="400" frameBorder="0" src="https://docs.google.com/spreadsheets/d/1r8QDUbOMKQwqkpX3vv8jYXc3li3qPMnoqrzmxGSui1I/edit?usp=sharing"></iframe>
        </div>
        <div class="split right" id="rightSplit">
            <div class="whiteOverlay split right">
            
            <div class = "container">
                <header>
                    <h1 id="gHeader">QR Code Scanner</h1>
                    <p>Upload QR Code or Scan with Webcam</p>
                </header>
                <div class="form">
                    <input type="file" id="fileInp" hidden>
                    <input type="text" name="text" id="text" readonly="" placeholder="QR Code Result" class="form-control">
                    <div class="btnPos">
                        <button id="upload">Upload QR Code</button>
                        <button id="scan">Scan QR Code</button>
                    </div>
                    <button id="gobackScan">Go Back</button>
                </div>

                <div class="webcam">
                    <video id="preview" width="100%"></video>
                </div>
            </div>

            <div id="myModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <p id="modalText"></p>
                </div>
            </div>  

            <div class="popup">
                <div class="box">
                    <br><a href = "#modify" class = "button" id="get_button">Pop Up</a>
                </div>
                <div class="overlay" id = "modify">
                    <div class="wrapper2">
                        <h2>Update <span id = "title_name"></span><br>Information</h2>
                        <h3 id="item_name"></h3>
                        <h3 id="item_desc"></h3>
                        <a href="#" class="close" id="close_button">&times;</a>
                        <div class="content">
                            <div class="container2">
                                <form>
                                    <div class="text">
                                        <h4 id="text1_desc">Student Class</h4>
                                        <input type="text" id="text1" name="text1" class="effect" placeholder="" autocomplete="off">
                                        <span class="focus-border"></span>
                                    </div>
                                    <div class="text">
                                        <h4 id="text2_desc">Student Name</h4>
                                        <input type="text" id="text2" name="text2" class="effect" placeholder="" autocomplete="off">
                                        <span class="focus-border"></span>
                                    </div>
                                    <div class="text">
                                        <h4 id="text3_desc">Condition</h4>
                                        <input type="text" id="text3" name="text3" class="effect" placeholder="" autocomplete="off">
                                        <span class="focus-border"></span>
                                    </div>
                                    <div class="text">
                                        <h4 id="text4_desc">Notes</h4>
                                        <input type="text" id="text4" name="text4" class="effect" placeholder="" autocomplete="off">
                                        <span class="focus-border"></span>
                                    </div>
                                    <a href="#" id="submit_button" class = "button2" role="button">Submit</a> 
                                    <label id= "verify">Field(s) are empty. <a onclick = "func2()" class="continue">Continue</a>?</label>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        
            <pre id="content" style="white-space: pre-wrap;"></pre>
            <!--<script type="text/javascript" src = "signin.js"></script>-->
            <script src="scannerScript.js"></script>
            <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
            <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
            <script async defer src="https://apis.google.com/js/api.js"></script>
        </div>
        </div>
    </body>
</html>

<script>
    let goback = document.getElementById("gobackScan");
    let navOpener = document.getElementById("opener");
    let rightSplit = document.getElementById("rightSplit");
    let leftSplit = document.getElementById("leftSplit");
    let openStatus = false;

    setInterval(function(){
        let viewportWidth = window.innerWidth;
        let adjustedWidth = viewportWidth - rightSplit.offsetWidth;
        let newWidth = adjustedWidth.toString() + 'px';
        leftSplit.style.width=newWidth;
    }, 0.1);   


    navOpener.addEventListener("click", ()=>{
        if(openStatus==false){
            openNav();
        }else if(openStatus== true){
            closeNav();
        }
    });

    goback.addEventListener("click", ()=>{
        window.location.href = "index.html";
    });
        /* Set the width of the sidebar to 250px and the left margin of the page content to 250px */
    function openNav() {
        openStatus = true;
        document.getElementById("mySidebar").style.width = "250px";
    }

    /* Set the width of the sidebar to 0 and the left margin of the page content to 0 */
    function closeNav() {
        openStatus=false;
        document.getElementById("mySidebar").style.width = "0";
    }

    let isSelected = false;
    let steinify = false;

    function setNewButton() {
    if (steinify == false) {
      document.getElementById("scanner").style.color = '#1b2282';
      document.getElementById("scanner").style.backgroundColor = '#f1f2fc';
    } else {
      document.getElementById("scanner").style.backgroundColor = '#e6f4ea';
      document.getElementById("scanner").style.color = '#188038';
    }
    document.getElementById("sheetsEmbed").style.backgroundColor = '';
    document.getElementById("sheetsEmbed").style.color = '';
    document.getElementById("rightSplit").style.width = "0vw";
  }

  function setExisting() {
    if (steinify == false) {
      document.getElementById("sheetsEmbed").style.color = '#1b2282';
      document.getElementById("sheetsEmbed").style.backgroundColor = '#f1f2fc';
    } else {
      document.getElementById("sheetsEmbed").style.color = '#188038';
      document.getElementById("sheetsEmbed").style.backgroundColor = '#e6f4ea';
    }
    document.getElementById("scanner").style.backgroundColor = '';
    document.getElementById("scanner").style.color = '';
    document.getElementById("rightSplit").style.width = "100vw";
  }

  let steinBtn = document.getElementById("steinify");

  steinBtn.addEventListener("click", ()=>{
      if (steinify == false) {
        document.getElementById("pageStyle").setAttribute("href", "style_steinify.css");  
        document.getElementById("steinify").style.color = '#188038';
        document.getElementById("steinify").style.backgroundColor = '#e6f4ea';
        steinify = true;
      } else {
        document.getElementById("pageStyle").setAttribute("href", "style.css");  
        document.getElementById("steinify").style.backgroundColor = '';
        document.getElementById("steinify").style.color = '';
        steinify = false;
      }
  });

  function setSheet() {
      let index = document.getElementById("selectSheet").selectedIndex;
      sheetsId = document.getElementById("selectSheet").options[index].value;
      let sharingLink = "https://docs.google.com/spreadsheets/d/" + sheetsId + "/edit?usp=sharing&chrome=false&widget=false";
      document.getElementById("frame").src = sharingLink;
  }
</script>