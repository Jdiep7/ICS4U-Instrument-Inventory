<html>
    <head>
        <title>Generate QR Codes</title>
        <link rel="stylesheet" href="styles.css">
    </head>
    <h2>Generate QR Codes</h2><br>
    <a id= "newQR" class= "button" href="#newQR" onclick="setButton()">New</a>
    <a id="existingQR" class= "button" href="#fromSheets" onclick="setButton()">From Spreadsheet</a>
    <a id="back" class="button" href="#" onclick="setButton()">Back</a>

    <br><br><div id = "newQR">
        <h2>New QR</h2>
        <select name="selectSheet" id="selectSheet" onchange="setSheet()">
            <option value="none" selected disabled hidden>Select a Spreadsheet</option>
            <option value="1mWEevuxx14kUZDClKsAREUGJvUWeXwoPDNK12aJPijY">Instruments</option>
            <option value="1FFqn2Oh-zi8j8foW5iq8qd_-m-hLk8LVrAXJpPa3Lo0">Books</option>
        </select>
        <div class="ranges">
            <h3>From</h3>
            <input type="number" id="setStartRange" placeholder="Start row">
        </div>
        <div class="ranges">
            <h3>index</h3>
            <input type="number" id="setStartRange" placeholder="Start row">
        </div>
        <div class="ranges">
            <h3>Amount</h3>
            <input type="number" id="setAmount" placeholder="Amount">
        </div>
        <div class="newValues">
            <h3>Name</h3>
            <select name="selectInstrument" id="selectInstrument" onchange="setInstrument()">
                <option value="none" selected disabled hidden>Instrument Name</option>
                <option value="FL">Flute</option>
                <option value="PIC">Piccolo</option>
                <option value="OBOE">Oboe</option>
                <option value="CL">Clarinet</option>
                <option value="ACL">Alto Clarinet</option>
                <option value="BCL">Bass Clarinet</option>
                <option value="AS">Alto Sax</option>
                <option value="TS">Tenor Sax</option>
                <option value="BS">Bari Sax</option>
                <option value="FH">French Horn</option>
                <option value="TRPT">Trumpet</option>
                <option value="TRBN">Trombone</option>
                <option value="BARBC">Baritone</option>
                <option value="BSN">Bassoon</option>
                <option value="TUBA">Tuba</option>
                <option value="PERC">Percussion</option>
                <option value="EB">Electric Bass</option>
                <option value="Piano">Piano</option>
                <option value="Conductor">Conductor</option>
            </select>
        </div>
        <div class="newValues">
            <h3>Company</h3>
            <input type="text" id= "newCompany" placeholder="Company">
        </div>
        <br><a id="generateNew" class="button">Generate</a>
    </div>
    
    <br><div id = "fromSheets">
        <h2>From Sheets</h2>
        <select name="selectSheet" id="selectSheet">
            <option value="none" selected disabled hidden>Select a Spreadsheet</option>
            <option value="1mWEevuxx14kUZDClKsAREUGJvUWeXwoPDNK12aJPijY">Instruments</option>
            <option value="1FFqn2Oh-zi8j8foW5iq8qd_-m-hLk8LVrAXJpPa3Lo0">Books</option>
        </select>
        <div class="ranges">
            <h3>From</h3>
            <input type="number" id="startRange" placeholder="Start row">
        </div>
        <div class="ranges">
            <h3>To</h3>
            <input type="number" id="endRange" placeholder="End row">
        </div>
        <br><a id="generate" class="button">Generate</a>

    </div>
    
    <div id="mySidebar" class="sidebar">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="#">Scan</a>
        <a href="edit.html">Sheets</a>
        <a href="#account">Account</a>
        <a href="#home">About</a>
    </div>
    
    <div id="main">
       <a class="openbtn" onclick="openNav()">&#9776;</a>
    </div>

    <script type="text/javascript" src = "edit.js"></script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
    <script async defer src="https://apis.google.com/js/api.js"></script>
    <script>
        let genbtn = document.getElementById("generate");
        let genNewBtn = document.getElementById("generateNew");
        var sheetsId = "none";
        var longName = "none";
        var shortName = "none";
        var r;
        document.getElementById("back").style.visibility = 'hidden';
        let isVisible = true;
        function setButton() {
            if (isVisible) {
                document.getElementById("newQR").style.visibility = 'hidden';
                document.getElementById("existingQR").style.visibility = 'hidden';
                document.getElementById("back").style.visibility = 'visible';
                isVisible = false;
            } else {
                document.getElementById("newQR").style.visibility = 'visible';
                document.getElementById("existingQR").style.visibility = 'visible';
                document.getElementById("back").style.visibility = 'hidden';
                isVisible = true;
            }
        }

        genbtn.addEventListener("click", ()=> {
            let start = document.getElementById("startRange").value;
            let end = document.getElementById("endRange").value;
            if (start < 4) {
                start = 4;
            }
            r = "A" + start + ":A" + end;
            console.log(r);
            getValues(sheetsId, r);
        });

        genNewBtn.addEventListener("click", ()=> {
            let index = document.getElementById("setStartRange").value;
            let amount = document.getElementById("setAmount").value;
            let company = document.getElementById("newCompany").value;
            if (sheetsId == "1mWEevuxx14kUZDClKsAREUGJvUWeXwoPDNK12aJPijY") {
                newInsQR(index, amount, longName, company, sheetsId);
            } 
            if (sheetsId == "1FFqn2Oh-zi8j8foW5iq8qd_-m-hLk8LVrAXJpPa3Lo0") {
                newBookQR(index, amount, shortName, sheetsId);
            }
        });

        function setSheet() {
            let index = document.getElementById("selectSheet").selectedIndex;
            console.log(document.getElementById("selectSheet").options[index].text)
            sheetsId = document.getElementById("selectSheet").options[index].value;
        }

        function setInstrument() {
            let index = document.getElementById("selectInstrument").selectedIndex;
            longName = document.getElementById("selectInstrument").options[index].text;
            shortName = document.getElementById("selectInstrument").options[index].value;
        }
    </script>
</html>